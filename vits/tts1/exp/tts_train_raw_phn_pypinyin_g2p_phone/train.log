# python3 -m espnet2.bin.tts_train --use_preprocessor true --token_type phn --token_list dump/token_list/phn_pypinyin_g2p_phone/tokens.txt --non_linguistic_symbols none --cleaner none --g2p pypinyin_g2p_phone --normalize global_mvn --resume true --fold_length 150 --fold_length 240000 --output_dir exp/tts_train_raw_phn_pypinyin_g2p_phone --feats_extract fbank --feats_extract_conf n_fft=2048 --feats_extract_conf hop_length=300 --feats_extract_conf win_length=1200 --feats_extract_conf fs=24000 --feats_extract_conf fmin=80 --feats_extract_conf fmax=7600 --feats_extract_conf n_mels=80 --train_data_path_and_name_and_type dump/raw/tr_no_dev/text,text,text --train_data_path_and_name_and_type dump/raw/tr_no_dev/wav.scp,speech,sound --train_shape_file exp/tts_stats_raw_phn_pypinyin_g2p_phone/train/text_shape.phn --train_shape_file exp/tts_stats_raw_phn_pypinyin_g2p_phone/train/speech_shape --valid_data_path_and_name_and_type dump/raw/dev/text,text,text --valid_data_path_and_name_and_type dump/raw/dev/wav.scp,speech,sound --valid_shape_file exp/tts_stats_raw_phn_pypinyin_g2p_phone/valid/text_shape.phn --valid_shape_file exp/tts_stats_raw_phn_pypinyin_g2p_phone/valid/speech_shape --normalize_conf stats_file=exp/tts_stats_raw_phn_pypinyin_g2p_phone/train/feats_stats.npz --ngpu 1 --multiprocessing_distributed True 
# Started at Mon Nov 17 08:21:47 UTC 2025
#
2025-11-17 08:21:54.147792: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1763367714.166875   24084 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1763367714.172789   24084 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1763367714.187278   24084 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1763367714.187304   24084 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1763367714.187307   24084 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1763367714.187309   24084 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-11-17 08:21:54.191611: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/usr/bin/python3 /content/espnet/espnet2/bin/tts_train.py --use_preprocessor true --token_type phn --token_list dump/token_list/phn_pypinyin_g2p_phone/tokens.txt --non_linguistic_symbols none --cleaner none --g2p pypinyin_g2p_phone --normalize global_mvn --resume true --fold_length 150 --fold_length 240000 --output_dir exp/tts_train_raw_phn_pypinyin_g2p_phone --feats_extract fbank --feats_extract_conf n_fft=2048 --feats_extract_conf hop_length=300 --feats_extract_conf win_length=1200 --feats_extract_conf fs=24000 --feats_extract_conf fmin=80 --feats_extract_conf fmax=7600 --feats_extract_conf n_mels=80 --train_data_path_and_name_and_type dump/raw/tr_no_dev/text,text,text --train_data_path_and_name_and_type dump/raw/tr_no_dev/wav.scp,speech,sound --train_shape_file exp/tts_stats_raw_phn_pypinyin_g2p_phone/train/text_shape.phn --train_shape_file exp/tts_stats_raw_phn_pypinyin_g2p_phone/train/speech_shape --valid_data_path_and_name_and_type dump/raw/dev/text,text,text --valid_data_path_and_name_and_type dump/raw/dev/wav.scp,speech,sound --valid_shape_file exp/tts_stats_raw_phn_pypinyin_g2p_phone/valid/text_shape.phn --valid_shape_file exp/tts_stats_raw_phn_pypinyin_g2p_phone/valid/speech_shape --normalize_conf stats_file=exp/tts_stats_raw_phn_pypinyin_g2p_phone/train/feats_stats.npz --ngpu 1 --multiprocessing_distributed True
Failed to import Flash Attention, using ESPnet default: No module named 'flash_attn'
/content/espnet/espnet2/train/trainer.py:638: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(
/content/espnet/espnet2/tts/espnet_model.py:93: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(False):
WARNING:root:Using make_pad_mask with a list of lengths is not tracable. If you try to trace this function with type(lengths) == list, please change the type of lengths to torch.LongTensor.
WARNING:root:Using make_pad_mask with a list of lengths is not tracable. If you try to trace this function with type(lengths) == list, please change the type of lengths to torch.LongTensor.
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/content/espnet/espnet2/bin/tts_train.py", line 22, in <module>
    main()
  File "/content/espnet/espnet2/bin/tts_train.py", line 18, in main
    TTSTask.main(cmd=cmd)
  File "/content/espnet/espnet2/tasks/abs_task.py", line 1281, in main
    cls.main_worker(args)
  File "/content/espnet/espnet2/tasks/abs_task.py", line 1638, in main_worker
    cls.trainer.run(
  File "/content/espnet/espnet2/train/trainer.py", line 343, in run
    all_steps_are_invalid = cls.train_one_epoch(
                            ^^^^^^^^^^^^^^^^^^^^
  File "/content/espnet/espnet2/train/trainer.py", line 643, in train_one_epoch
    retval = model(**batch)
             ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/espnet/espnet2/tts/espnet_model.py", line 151, in forward
    return self.tts(**batch)
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/espnet/espnet2/tts/tacotron2/tacotron2.py", line 324, in forward
    after_outs, before_outs, logits, att_ws = self._forward(
                                              ^^^^^^^^^^^^^^
  File "/content/espnet/espnet2/tts/tacotron2/tacotron2.py", line 414, in _forward
    return self.dec(hs, hlens, ys)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/content/espnet/espnet/nets/pytorch_backend/tacotron2/decoder.py", line 441, in forward
    xs = torch.cat([att_c, prenet_out], dim=1)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Tensors must have same number of dimensions: got 2 and 3
# Accounting: time=35 threads=1
# Ended (code 1) at Mon Nov 17 08:22:22 UTC 2025, elapsed time 35 seconds
